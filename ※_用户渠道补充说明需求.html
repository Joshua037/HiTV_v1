<!DOCTYPE html>
<html>
  <head>
    <title>※ 用户渠道补充说明需求</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link href="resources/css/axure_rp_page.css" type="text/css" rel="stylesheet"/>
    <link href="data/styles.css" type="text/css" rel="stylesheet"/>
    <link href="files/※_用户渠道补充说明需求/styles.css" type="text/css" rel="stylesheet"/>
    <script src="resources/scripts/jquery-3.7.1.min.js"></script>
    <script src="resources/scripts/axure/axQuery.js"></script>
    <script src="resources/scripts/axure/globals.js"></script>
    <script src="resources/scripts/axutils.js"></script>
    <script src="resources/scripts/axure/annotation.js"></script>
    <script src="resources/scripts/axure/axQuery.std.js"></script>
    <script src="resources/scripts/axure/doc.js"></script>
    <script src="resources/scripts/messagecenter.js"></script>
    <script src="resources/scripts/axure/events.js"></script>
    <script src="resources/scripts/axure/recording.js"></script>
    <script src="resources/scripts/axure/action.js"></script>
    <script src="resources/scripts/axure/expr.js"></script>
    <script src="resources/scripts/axure/geometry.js"></script>
    <script src="resources/scripts/axure/flyout.js"></script>
    <script src="resources/scripts/axure/model.js"></script>
    <script src="resources/scripts/axure/repeater.js"></script>
    <script src="resources/scripts/axure/sto.js"></script>
    <script src="resources/scripts/axure/utils.temp.js"></script>
    <script src="resources/scripts/axure/variables.js"></script>
    <script src="resources/scripts/axure/drag.js"></script>
    <script src="resources/scripts/axure/move.js"></script>
    <script src="resources/scripts/axure/visibility.js"></script>
    <script src="resources/scripts/axure/style.js"></script>
    <script src="resources/scripts/axure/adaptive.js"></script>
    <script src="resources/scripts/axure/tree.js"></script>
    <script src="resources/scripts/axure/init.temp.js"></script>
    <script src="resources/scripts/axure/legacy.js"></script>
    <script src="resources/scripts/axure/viewer.js"></script>
    <script src="resources/scripts/axure/math.js"></script>
    <script src="resources/scripts/axure/jquery.nicescroll.min.js"></script>
    <script src="data/document.js"></script>
    <script src="files/※_用户渠道补充说明需求/data.js"></script>
    <script type="text/javascript">
      $axure.utils.getTransparentGifPath = function() { return 'resources/images/transparent.gif'; };
      $axure.utils.getOtherPath = function() { return 'resources/Other.html'; };
      $axure.utils.getReloadPath = function() { return 'resources/reload.html'; };
    </script>
  </head>
  <body>
    <div id="base" class="">

      <!-- Unnamed (矩形) -->
      <div id="u5492" class="ax_default _一级标题">
        <div id="u5492_div" class=""></div>
        <div id="u5492_text" class="text ">
          <p><span>“渠道管理”模块 - 补充说明</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5493" class="ax_default _一级标题">
        <div id="u5493_div" class=""></div>
        <div id="u5493_text" class="text ">
          <p><span>需求目的：</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5494" class="ax_default _文本段落">
        <div id="u5494_div" class=""></div>
        <div id="u5494_text" class="text ">
          <p><span>针对未注册或未登陆的用户如何记录其在线时长以及观影时长达到归集条件</span></p><p><span>目前平台为免费视频平台，注册用户与非注册用户在平台使用层面目前还未能体现差异性，因此导致很多用户都属于非注册用户，但这些用户的价值与注册用户处于统一水平，因此针对品牌渠道推广的目的对于这类用于同样存在这与注册用户同等价值</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5495" class="ax_default _一级标题">
        <div id="u5495_div" class=""></div>
        <div id="u5495_text" class="text ">
          <p><span>需求说明：</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5496" class="ax_default _文本段落">
        <div id="u5496_div" class=""></div>
        <div id="u5496_text" class="text ">
          <p><span>本部分补充说明部分针对未注册或未登陆用户记录其在线时长与观影时长</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5497" class="ax_default _文本段落">
        <div id="u5497_div" class=""></div>
        <div id="u5497_text" class="text ">
          <p><span>1. 数据层</span></p>
        </div>
      </div>

      <!-- Unnamed (图片) -->
      <div id="u5498" class="ax_default _图片_">
        <img id="u5498_img" class="img " src="images/※_用户渠道补充说明需求/u5498.png"/>
        <div id="u5498_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5499" class="ax_default _文本段落">
        <div id="u5499_div" class=""></div>
        <div id="u5499_text" class="text ">
          <p style="font-size:12px;"><span style="color:#D9001B;">※&nbsp; 上图为举例说明，技术可结合当前技术的数据结构灵活修改</span></p><p style="font-size:12px;"><span style="color:#D9001B;"><br></span></p><p style="font-size:14px;"><span style="color:#000000;">UserTable：为现在平台已有的用户表，在此表中添加字段“UserThumbprint”并作为外键用于关联归集时长表；</span></p><p style="font-size:14px;"><span style="color:#000000;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 此表的主键仍然为UserID用于关联当前平台所有业务表</span></p><p style="font-size:14px;"><span style="color:#000000;">OperationTable： 泛指当前平台的其他业务表，本需求内不做赘述</span></p><p style="font-size:14px;"><span style="color:#000000;">PoolingTime：为新增表，主要用于记录用户痕迹和归集条件时长</span></p><ul><li style="font-size:14px;"><span style="color:#000000;">ThumbPrintID：为本表主键，与UserTable关联；</span></li><li style="font-size:14px;"><span style="color:#000000;">BrowserFingerPrint：为浏览器职位，记录用户使用的浏览器编码，主要用于标识用户使用设备</span></li><li style="font-size:14px;"><span style="color:#000000;">IP_Address：记录用户访问时的IP地址，用于辅助浏览器指纹确定未登陆用户身份</span></li><li style="font-size:14px;"><span style="color:#000000;">UserID：针对已注册用户标识</span></li><li style="font-size:14px;"><span style="color:#000000;">OnlineTime：记录用户在线累计时长</span></li><li style="font-size:14px;"><span style="color:#000000;">ViewTime：记录用户观影累计时长</span></li></ul><p style="font-size:14px;"><span style="color:#000000;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5500" class="ax_default _文本段落">
        <div id="u5500_div" class=""></div>
        <div id="u5500_text" class="text ">
          <p><span>2. 业务层 - 可以理解为一个用户经历了两次注册，第一次由系统自动注册其影子身份，第二次由用户主动注册账号</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5501" class="ax_default label">
        <div id="u5501_div" class=""></div>
        <div id="u5501_text" class="text ">
          <p><span>用户访问渠道A的网址</span></p><p><span>肯定处于未登录状态</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5502" class="ax_default label">
        <div id="u5502_div" class=""></div>
        <div id="u5502_text" class="text ">
          <p><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">进入渠道A后第一件事就是比对</span><span style="font-family:'微软雅黑', sans-serif;">Pooling</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">表，通过</span><span style="font-family:'微软雅黑', sans-serif;">IP</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">地址和浏览器指纹确定该用户是否访问过渠道</span><span style="font-family:'微软雅黑', sans-serif;">A</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;"> （</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;color:#D9001B;">※ 注意：是访问，不是注册登录</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">）</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5503" class="ax_default label">
        <div id="u5503_div" class=""></div>
        <div id="u5503_text" class="text ">
          <p><span>没有记录证明该用户第一次访问渠道A，所以需要创建痕迹身份</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5504" class="ax_default label">
        <div id="u5504_div" class=""></div>
        <div id="u5504_text" class="text ">
          <p><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">痕迹身份赢先为用户创建</span><span style="font-family:'微软雅黑', sans-serif;">Pooling</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">表身份，同时创建User默认身份</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5505" class="ax_default _文本段落">
        <div id="u5505_div" class=""></div>
        <div id="u5505_text" class="text ">
          <p><span style="font-family:'微软雅黑', sans-serif;">User</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">表的</span><span style="font-family:'微软雅黑', sans-serif;">UserID</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">随机生成后</span><span style="font-family:'微软雅黑', sans-serif;">update</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">到</span><span style="font-family:'微软雅黑', sans-serif;">pooling</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">表，</span><span style="font-family:'微软雅黑', sans-serif;">ThumbPrintID</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">随机生成后</span><span style="font-family:'微软雅黑', sans-serif;">Insert</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">到</span><span style="font-family:'微软雅黑', sans-serif;">User</span><span style="font-family:'微软雅黑', sans-serif;font-weight:400;font-style:normal;">表</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5506" class="ax_default label">
        <div id="u5506_div" class=""></div>
        <div id="u5506_text" class="text ">
          <p><span>如果有记录则证明该用户之前访问过渠道A并有累计时长</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5507" class="ax_default label">
        <div id="u5507_div" class=""></div>
        <div id="u5507_text" class="text ">
          <p><span>通过该用户的IP地址和浏览器指纹找到该用户的痕迹身份，并累加本次在线时长和观影时长</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5508" class="ax_default label">
        <div id="u5508_div" class=""></div>
        <div id="u5508_text" class="text ">
          <p><span>如果用户进行注册，因为在创建影子身份的时候User表已有对应信息，通过查询影子身份ID关联User表对应数据</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5509" class="ax_default label">
        <div id="u5509_div" class=""></div>
        <div id="u5509_text" class="text ">
          <p><span>找到在User表里对应的身份信息将用户注册信息Update到User表里即可</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5510" class="ax_default label">
        <div id="u5510_div" class=""></div>
        <div id="u5510_text" class="text ">
          <p><span>如果用户采取登录操作，则可通过获得User表中的UserID获取影子身份数据</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5511" class="ax_default label">
        <div id="u5511_div" class=""></div>
        <div id="u5511_text" class="text ">
          <p><span>根据UserID可以在影子身份表中继续累计该用户的在线时长和观影时长</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5512" class="ax_default label">
        <div id="u5512_div" class=""></div>
        <div id="u5512_text" class="text ">
          <p><span>当用户在影子身份表中的累计时间满足归集条件后，再次访问A网址时，域名不改变但针对该用户A域名将指向归集渠道B的页面</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5513" class="ax_default label">
        <div id="u5513_div" class=""></div>
        <div id="u5513_text" class="text ">
          <p><span>若不满足归集条件，则该用户访问A时继续指向原来的渠道A</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5514" class="ax_default _文本段落">
        <div id="u5514_div" class=""></div>
        <div id="u5514_text" class="text ">
          <p><span>3. 特殊情况</span></p><ul><li style=""><span>当同用户注册两个账号，IP地址和浏览器指纹一致，在影子表中会同步两个账号的累计时长，无论用户登录哪个账号，均对两个账号都累计相应时长；</span></li><li style=""><span>当用户IP地址更改但浏览器指纹一致时，我们可以理解为该用户使用移动端浏览链接不同的WIFI导致，在影子身份表中Insert该条新的IP地址记录，以便于用户在下次使用该wifi时可以继续累计，但归集该用户时长会通过浏览器指纹和Userid为归集查询条件；</span></li><li style=""><span>当用户浏览器指纹更改但IP一致时，可以理解为该用户更换浏览器浏览导致，在影子身份表中Insert该条新数据的浏览器指纹，以便于用户下次使用该浏览器时身份不会分裂</span></li><li style=""><span>当用户IP地址和浏览器指纹均无记录时会为其注册新的影子身份，但当该用户本次登录账号时则会将新影子身份中的UserID数据Update为登录的UserID</span></li></ul>
        </div>
      </div>

      <!-- Unnamed (图片) -->
      <div id="u5515" class="ax_default _图片_">
        <img id="u5515_img" class="img " src="images/※_用户渠道补充说明需求/u5515.png"/>
        <div id="u5515_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>
    </div>
    <script src="resources/scripts/axure/ios.js"></script>
  </body>
</html>
